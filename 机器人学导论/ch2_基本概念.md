# 2. 基本概念
## 1. 位姿描述
刚体参考点的位置和刚体的姿态统称为刚体的位姿
1. 位置在三维空间中直角坐标系下可以用$^Ap=[p_x, p_y, p_z]^{\top}$表示，左上角的A表示在A坐标系下
2. 为了规定刚体B的方位，设坐标系B与刚体固连，然后就可以用坐标系B的三个单位主矢量$x_B, y_B, z_B$(其实就是坐标系B的xyz轴单位矢量在A下的表示)相对于坐标系A的方向余弦组成的矩阵来表示相对于A的方位，矩阵为：
$$_B^AR=[^Ax_B, ^Ay_B, ^Az_B]=\left[\begin{matrix}
r_{11} & r_{12} & r_{13} \\
r_{21} & r_{22} & r_{23} \\ 
r_{31} & r_{32} & r_{33} \\ 
\end{matrix}\right] $$
    姿态直观理解就是机器人的朝向(这里就不是把机器人看做质点了)，描述这个坐标系需要确定他的三个坐标轴，所以上面的矩阵其实就是通过描述坐标系B在A下三个坐标轴的方向来确定的坐标系B
![20200227130425.png](https://raw.githubusercontent.com/s974534426/img_for_notes/master/20200227130425.png)
3. 旋转矩阵是正交矩阵，即$_B^AR^{\top} = _B^AR^{-1}$
4. 需要记住的特殊的旋转矩阵
$$ R(x, \theta) = \left[\begin{matrix}
    1 & 0 & 0 \\
    0 & cos\theta & -sin\theta \\
    0 & sin\theta & cos\theta \\
\end{matrix}\right] $$
$$ R(y, \theta) = \left[\begin{matrix}
    cos\theta & 0 & sin\theta \\
    0 & 1 & 0 \\
    -sin\theta & 0 & cos\theta \\
\end{matrix}\right] $$
$$ R(z, \theta) = \left[\begin{matrix}
    cos\theta & -sin\theta & 0 \\
    sin\theta & cos\theta & 0 \\
    0 & 0 & 1 \\
\end{matrix}\right] $$

## 2. 坐标变换
### 1. 平移坐标变换
$$^Ap=_B^AR^Bp+^Ap_{B}$$
这个很好理解，就是先对在B系中的点进行旋转变换，得到一个中间状态的坐标系，这个坐标系再平移

## 3. 齐次坐标变换
### 1. 定义
齐次坐标就是将一个原本n维的向量用一个n+1维向量来表示$p=[x, y, z, 1]^{\top}=[wx, wy, wz, w]^{\top}$
引入齐次坐标系，可以更有效方便地使用矩阵运算
1. 方向，齐次坐标可以表示无穷远的点，即用无限远矢量表示方向，只要把增加的一维设置为0
2. 位置，增加的一维设置为$w$
### 2. 齐次变换矩阵
$$\left[\begin{matrix}
^Ap \\
1 \\ 
\end{matrix}\right] = 
\left[\begin{matrix}
 & _B^AR &  & ^Ap_B \\
0 & 0 & 0 & 1 \\ 
\end{matrix}\right]
\left[\begin{matrix}
^Bp \\
1 \\ 
\end{matrix}\right]
$$
可以表示成$^Ap=_B^AT^Bp$
1. 对齐次矩阵，可以看到，前三列增加的一维为0，表示的是旋转矩阵的姿态，第四列增加的是1，表示的是位置
2. 如果旋转矩阵是单位矩阵，则只有平移，如果第四列前三行都为0，则只有旋转，同时也可以把他拆分为旋转矩阵和平移矩阵的相乘，更容易理解变换的过程

## 4. 物体的变换和变换方程
### 1. 复合变换
$_C^AT=_B^AT_C^BT$
### 2. 变换矩阵的左乘和右乘(这个很重要)
1. 固定坐标系指的是某一个不动的全局坐标系，相对应的是运动坐标系，运动坐标系会随着物体的旋转而旋转，这两种情况下计算是不同的。
2. 如果一系列变换是相对固定坐标系的，则变换式从右向左写，这里如果把每一次变换拆分开，对最右边的位置向量从有向左依次进行变换，会比较好理解
3. 相对运动坐标系，则是从左往右写，这里利用上下标，直接计算出从最终的旋转矩阵会比较好理解

### 3. 逆变换
也就是齐次矩阵求逆的过程，这里主要是要利用旋转矩阵是一个正交矩阵的性质，直接给出公式
$$_A^BT = \left[\begin{matrix}
_B^AR^T & | & -_B^AR^{TA}p_B \\
0 & | & 1 \\
\end{matrix}\right]
$$

## 5. 欧拉角和rpy角
主要区别是RPY角绕固定轴旋转，欧拉角绕运动轴旋转(注意这两种情况是不同的，参考前面的左乘和右乘)，然后可以通过代入第一节中的那三个需要记住的旋转矩阵就可以得到旋转矩阵了
得到旋转矩阵之后利用对应元素相等，就可以从旋转矩阵得到旋转角的值
1. xyzRPY角：$RPY(\alpha, \beta, \gamma) = R(z, \alpha)R(y, \beta)R(x, \gamma)$
2. zyx欧拉角：$^A_BR_{zyx}(\alpha, \beta, \gamma) = R(z, \alpha)R(y, \beta)R(x, \gamma)$，注意是从左往右，所以是先绕z再y再x
3. 绕固定轴旋转的顺序与绕运动轴旋转的顺序相反，且旋转角度相同时，得到的变换矩阵也完全相同

## 6. 通用旋转变换
绕从原点出发的任意向量旋转$\theta$角度的矩阵
我们有一个初始坐标系A，有一个和与A重合的坐标系B，现在有一个过原点的矢量$f$，求B绕$f$旋转$\theta$后得到的坐标系
假想有一个坐标系C，C的z轴和f重合，xy轴随意，我们可以得到$_C^AT$，在C坐标系下，绕z轴旋转矩阵为$_D^CT=Rot(z, \theta)$
由于B坐标系和C坐标系一同旋转，所以旋转矩阵应该是相同的，即$_D^BT=_C^AT$
最终可以得到$_B^AT=_C^AT_D^CT_B^DT=_C^AT_D^CT_D^BT^{-1}=_C^AT_D^CT_C^AT^{-1}$
![20200304184331.png](https://raw.githubusercontent.com/s974534426/img_for_notes/master/20200304184331.png)
